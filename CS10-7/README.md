# 📖 용어 정리
- 프로그램  
어떤 작업을 위해 운영체제 위에서 실행할 수 있는 파일  
ex) 웹 브라우저, 워드 프로세서, 카카오톡 등
- 프로세스  
운영 체제 위에서 **실행 중**인 프로그램  
프로그램 명령어와 데이터들이 메모리에 올라오고 실행 중 또는 실행 대기 중인 상태
- 프로세서  
프로세스가 동작될 수 있도록 하는 하드웨어(**CPU**)  
프로그램의 자원들이 메모리에 올라오고, 실행되어야 할 코드의 메모리 주소를 CPU의 레지스터로 올려준다.  
- 코어  
코어란 각종 연산을 하는 CPU의 핵심요소이며, CPU 내부에는 코어 말고도 컨트롤러, 캐시 메모리 등이 들어있다.  
CPU 안에서 일하는 부품 중 가장 중요한 역할이다.  
코어가 많을수록 일을 처리하는 사람이 많아지는 것이기 때문에 많으면 많을수록 처리속도가 빨라진다.
- 스레드
프로세스는 운영체제로부터 자원을 할당받는 작업의 단위이고,  
스레드는 프로세스가 할당받은 자원을 이용하는 실행의 단위이다.  
<br>
<br>

# 🧐 멀티 태스킹이란?
CPU는 **한순간에 하나의 프로세스**만 실행할 수 있다.  
그러나 운영체제가 짧은 시간에 수십번에서 수천번 실행할 프로세스를 **교체**하고 있기 때문에  
우리는 동시에 여려 개의 작업이 실행되고 있다고 느끼는 것이다.  
이런 교체 과정을 컨텍스트 스위칭이라고 한다.
<br>

## Context Switching
![context_switching](https://user-images.githubusercontent.com/17706346/150735655-d8b06438-832c-487a-8c20-f472a4b07eb4.png)  
Task 1에서 Task 2로, Task 2에서 Task 1로 교체되는 시점마다  
어떤 작업으로 교체해야하는지, 이전 작업이 어디까지 진행됐는지 교체할 작업을 어디부터 시작하면 되는지에 대한  
작업이 이뤄지는 순간을 컨텍스트 스위칭이라고 한다.  
다양한 방식과 알고리즘이 쓰인다.
<br>
<br>

# 🧐 멀티 프로세스란?
## 프로세스 구조
![process_structure](https://user-images.githubusercontent.com/17706346/150738037-44e2625d-c1e9-450e-98ea-0c8a1e567362.png)  
Stack - 호출된 함수, 지역변수 등 임시 데이터  
Heap - 동적으로 생긴 데이터 ex) new Object(), malloc()  
Data - 전역변수 ex) static 변수, global 변수  
Code - 프로그램의 코드  
<br>
// TODO
<br>
<br>

# 🧐 멀티 스레드란?
// TODO
<br>
<br>

# 멀티 프로세스 스케줄링
## 기능요구사항
- [X] 마치 운영체제가 프로세스를 스케줄링하는 것처럼 프로세스를 일정한 시간동안 실행하는 프로그램을 구현한다.
- [X] 프로세스 종류를 5개 정하고, 프로세스 마다 최대 동작 시간을 겹치지 않도록 결정한다.  
    예) 프로세스A : 3초, 프로세스B : 5초, 프로세스C : 7초, 프로세스D : 10초, 프로세스E : 15초
- [X] 우리가 목표로 하는 운영체제는 한 번에 프로세스 하나씩만 1초동안만 실행할 수 있다. 해당 프로세스 외 다른 프로세스는 실행하지 않는다.
- [X] 1초 이후에는 같은 프로세스가 아니라 다른 프로세스를 실행해야 한다. 만약 프로세스가 1개만 남은 경우 반복해서 같은 프로세스를 실행할 수 있다.
- [X] 프로세스 상태는 준비ready, 실행running, 대기waiting, 종료terminated 4 가지 상태 중에 하나다.  
<br>

## 프로그래밍 요구사항
- [X] 이 프로그램을 시작하면, 랜덤으로 프로세스 3개를 생성하고 대기 큐에 추가한다.
- [X] 프로세스는 ready 또는 waiting 상태에서만 실행상태로 바뀔 수 있다.
- [X] 누적 동작 시간이 최대 동작 시간만큼 실행한 프로세스는 terminated 상태로 바뀐다.
- [X] 누적 동작 시간이 최대 동작 시간보다 작으면 다시 waiting 상태가 된다.
- [X] 프로세스마다 작업 정보를 포함하는 데이터 구조 또는 타입을 선언한다.
- [X] 단지 출력을 하기 위한 프로그램을 작성하는 게 아니라, 프로세스 타입을 선언하고 프로세스마다 1초씩 동작하는 구조를 구현해야 한다.
- [X] 프로그램은 1초마다 전체 프로세스 상태와 누적 실행 시간을 표시한다.
- [X] 프로그램은 모든 프로세스가 멈추고 나면 종료한다.  
<br>

## 구현 설명
[https://gist.github.com/jindonyy/10e988a921186380cce52b0b35ae1954#file-multi_process-js](https://gist.github.com/jindonyy/10e988a921186380cce52b0b35ae1954#file-multi_process-js)
1. 랜덤으로 선택되는 프로세스가 중복되지 않고, 맨 앞의 요소 삭제의 시간복잡도를 줄일 수 있도록 `Map`을 사용
```javascript
this.process = new Map();
this.queue = new Map();
```
2. `setProcess`와 `setQueue`에서 프로세스와 큐 셋팅
3. Map은 인덱스로 선택이 되지 않아 entrise를 이용하여 첫번째 요소를 선택하여 큐에서 추가, 삭제를 해주었다.
```javascript
const queueList = this.queue.entries();
const current = queueList.next(); // 첫번째 요소 선택
```

## 구현 결과
<img width="218" src="https://user-images.githubusercontent.com/17706346/150852863-9ccf3d46-2d74-4c00-bc5a-179021a849c4.png">  
<img width="300" src="https://user-images.githubusercontent.com/17706346/150852883-fcd77a9e-06d8-4a47-bcc2-7f2cf2cf48d5.png">
